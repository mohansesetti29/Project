<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>InterviewAI ‚Äî Your Personal Interview Coach</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:ital,wght@0,400;0,500;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0f;
    --surface: #12121a;
    --surface2: #1a1a26;
    --border: #2a2a3d;
    --accent: #7c3aed;
    --accent2: #06d6a0;
    --accent3: #f72585;
    --text: #e8e8f0;
    --muted: #6b6b8a;
    --danger: #ff4d6d;
    --warn: #ffd60a;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Grid background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: 
      linear-gradient(rgba(124,58,237,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(124,58,237,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  .glow-orb {
    position: fixed;
    border-radius: 50%;
    filter: blur(80px);
    pointer-events: none;
    z-index: 0;
  }
  .orb1 { width: 400px; height: 400px; background: rgba(124,58,237,0.15); top: -100px; right: -100px; }
  .orb2 { width: 300px; height: 300px; background: rgba(6,214,160,0.08); bottom: 100px; left: -80px; }

  /* SCREENS */
  .screen { display: none; position: relative; z-index: 1; min-height: 100vh; }
  .screen.active { display: flex; }

  /* ===== SCREEN 1: LANDING ===== */
  #screen-landing {
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 40px 20px;
    text-align: center;
  }

  .logo-mark {
    width: 64px; height: 64px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 18px;
    display: flex; align-items: center; justify-content: center;
    font-family: 'Syne', sans-serif;
    font-size: 28px; font-weight: 800;
    margin: 0 auto 24px;
    box-shadow: 0 0 40px rgba(124,58,237,0.4);
    animation: float 3s ease-in-out infinite;
  }

  @keyframes float {
    0%,100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }

  .landing-eyebrow {
    font-family: 'DM Mono', monospace;
    font-size: 12px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--accent2);
    margin-bottom: 16px;
  }

  .landing-title {
    font-family: 'Syne', sans-serif;
    font-size: clamp(40px, 7vw, 72px);
    font-weight: 800;
    line-height: 1.05;
    margin-bottom: 20px;
    background: linear-gradient(135deg, #fff 30%, var(--accent) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .landing-sub {
    font-size: 18px;
    color: var(--muted);
    max-width: 500px;
    line-height: 1.7;
    margin-bottom: 48px;
  }

  .features-row {
    display: flex;
    gap: 16px;
    margin-bottom: 48px;
    flex-wrap: wrap;
    justify-content: center;
  }

  .feat-chip {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 100px;
    padding: 8px 18px;
    font-size: 13px;
    font-family: 'DM Mono', monospace;
    color: var(--muted);
    display: flex; align-items: center; gap: 8px;
  }
  .feat-chip span { color: var(--accent2); }

  .btn-primary {
    background: linear-gradient(135deg, var(--accent), #9d5bf7);
    color: white;
    border: none;
    padding: 16px 40px;
    border-radius: 12px;
    font-size: 16px;
    font-family: 'Syne', sans-serif;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 0 30px rgba(124,58,237,0.4);
    letter-spacing: 0.5px;
  }
  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 0 50px rgba(124,58,237,0.6);
  }

  /* ===== SCREEN 2: PROFILE ===== */
  #screen-profile {
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    padding: 60px 20px;
  }

  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 40px;
    width: 100%;
    max-width: 560px;
  }

  .card-header {
    margin-bottom: 32px;
  }

  .step-badge {
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--accent2);
    margin-bottom: 8px;
  }

  .card-title {
    font-family: 'Syne', sans-serif;
    font-size: 28px;
    font-weight: 800;
    color: var(--text);
  }

  .form-group {
    margin-bottom: 20px;
  }

  label {
    display: block;
    font-size: 12px;
    font-family: 'DM Mono', monospace;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 8px;
  }

  input, select, textarea {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px 16px;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 15px;
    outline: none;
    transition: border-color 0.2s;
    appearance: none;
  }

  input:focus, select:focus, textarea:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(124,58,237,0.15);
  }

  select option { background: var(--surface2); }

  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
  }

  .skills-input-wrap { position: relative; }
  .skills-tags {
    display: flex; flex-wrap: wrap; gap: 8px;
    margin-top: 10px;
  }
  .skill-tag {
    background: rgba(124,58,237,0.2);
    border: 1px solid rgba(124,58,237,0.4);
    border-radius: 6px;
    padding: 4px 12px;
    font-size: 13px;
    font-family: 'DM Mono', monospace;
    color: #a78bfa;
    cursor: pointer;
    transition: all 0.15s;
  }
  .skill-tag:hover { background: rgba(247,37,133,0.2); border-color: var(--accent3); color: var(--accent3); }

  /* ===== SCREEN 3: INTERVIEW ===== */
  #screen-interview {
    flex-direction: column;
    padding: 0;
    background: var(--bg);
  }

  .interview-layout {
    display: grid;
    grid-template-columns: 1fr 380px;
    height: 100vh;
    gap: 0;
  }

  .interview-main {
    display: flex;
    flex-direction: column;
    padding: 32px;
    gap: 24px;
    overflow-y: auto;
  }

  .interview-sidebar {
    background: var(--surface);
    border-left: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    padding: 24px;
    gap: 20px;
  }

  /* Video feed */
  .video-container {
    position: relative;
    border-radius: 16px;
    overflow: hidden;
    background: #000;
    aspect-ratio: 16/9;
    border: 1px solid var(--border);
  }

  #webcam {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transform: scaleX(-1);
  }

  .video-overlay {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }

  .cam-corner {
    position: absolute;
    width: 20px; height: 20px;
    border-color: var(--accent2);
    border-style: solid;
    opacity: 0.7;
  }
  .cam-corner.tl { top: 12px; left: 12px; border-width: 2px 0 0 2px; }
  .cam-corner.tr { top: 12px; right: 12px; border-width: 2px 2px 0 0; }
  .cam-corner.bl { bottom: 12px; left: 12px; border-width: 0 0 2px 2px; }
  .cam-corner.br { bottom: 12px; right: 12px; border-width: 0 2px 2px 0; }

  .rec-indicator {
    position: absolute;
    top: 12px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(8px);
    border-radius: 100px;
    padding: 4px 12px;
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    letter-spacing: 1px;
    color: var(--danger);
    display: flex; align-items: center; gap: 6px;
  }
  .rec-dot {
    width: 6px; height: 6px;
    background: var(--danger);
    border-radius: 50%;
    animation: blink 1s ease-in-out infinite;
  }
  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.2} }

  /* Emotion bar */
  .emotion-panel {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px;
  }

  .emotion-title {
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 14px;
  }

  .emotion-bars { display: flex; flex-direction: column; gap: 10px; }

  .emotion-row {
    display: flex; align-items: center; gap: 10px;
  }

  .emotion-label {
    font-size: 12px;
    color: var(--muted);
    width: 70px;
    flex-shrink: 0;
  }

  .emotion-bar-bg {
    flex: 1;
    height: 6px;
    background: var(--border);
    border-radius: 3px;
    overflow: hidden;
  }

  .emotion-bar-fill {
    height: 100%;
    border-radius: 3px;
    transition: width 0.5s ease;
  }

  .emotion-val {
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    color: var(--muted);
    width: 32px;
    text-align: right;
  }

  /* AI Chat / Questions */
  .chat-area {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 16px;
    overflow-y: auto;
    padding-right: 4px;
  }

  .chat-area::-webkit-scrollbar { width: 4px; }
  .chat-area::-webkit-scrollbar-track { background: transparent; }
  .chat-area::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

  .message {
    display: flex;
    gap: 12px;
    animation: slideIn 0.3s ease;
  }

  @keyframes slideIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .msg-avatar {
    width: 36px; height: 36px;
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: 16px;
    flex-shrink: 0;
  }

  .msg-avatar.ai { background: linear-gradient(135deg, var(--accent), #9d5bf7); }
  .msg-avatar.user { background: var(--surface2); border: 1px solid var(--border); }

  .msg-bubble {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 14px 18px;
    max-width: 85%;
    font-size: 15px;
    line-height: 1.6;
  }

  .msg-bubble.ai-bubble {
    background: rgba(124,58,237,0.1);
    border-color: rgba(124,58,237,0.3);
  }

  .msg-meta {
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    color: var(--muted);
    margin-bottom: 6px;
  }

  /* Voice input */
  .voice-input-area {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 16px 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .voice-visualizer {
    display: flex;
    align-items: center;
    gap: 3px;
    height: 32px;
    justify-content: center;
  }

  .voice-bar {
    width: 4px;
    background: var(--accent);
    border-radius: 2px;
    transition: height 0.1s;
    opacity: 0.5;
  }

  .voice-bar.active { opacity: 1; animation: voiceAnim 0.5s ease-in-out infinite alternate; }

  @keyframes voiceAnim {
    from { height: 4px; }
    to { height: 28px; }
  }

  .voice-controls {
    display: flex;
    gap: 10px;
    align-items: center;
  }

  .btn-mic {
    width: 48px; height: 48px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    font-size: 20px;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.2s;
    flex-shrink: 0;
  }

  .btn-mic.idle { background: var(--surface); border: 1px solid var(--border); }
  .btn-mic.recording {
    background: var(--danger);
    box-shadow: 0 0 20px rgba(255,77,109,0.5);
    animation: pulse 1s ease infinite;
  }

  @keyframes pulse {
    0%,100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  #answer-text {
    flex: 1;
    resize: none;
    height: 60px;
    font-size: 14px;
  }

  .btn-send {
    background: var(--accent);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 10px;
    font-family: 'Syne', sans-serif;
    font-size: 14px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
  }
  .btn-send:hover { background: #9d5bf7; }

  /* Progress */
  .progress-panel {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px;
  }

  .progress-label {
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 12px;
  }

  .progress-track {
    height: 6px;
    background: var(--border);
    border-radius: 3px;
    overflow: hidden;
    margin-bottom: 8px;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    border-radius: 3px;
    transition: width 0.5s ease;
  }

  .progress-info {
    display: flex;
    justify-content: space-between;
    font-family: 'DM Mono', monospace;
    font-size: 12px;
    color: var(--muted);
  }

  /* Interview header */
  .interview-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--border);
  }

  .interviewer-info {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .interviewer-avatar {
    width: 44px; height: 44px;
    border-radius: 12px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    display: flex; align-items: center; justify-content: center;
    font-size: 20px;
  }

  .interviewer-name {
    font-family: 'Syne', sans-serif;
    font-weight: 700;
    font-size: 16px;
  }

  .interviewer-role {
    font-size: 12px;
    color: var(--muted);
    font-family: 'DM Mono', monospace;
  }

  .status-badge {
    background: rgba(6,214,160,0.15);
    border: 1px solid rgba(6,214,160,0.3);
    color: var(--accent2);
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    letter-spacing: 1px;
    padding: 4px 12px;
    border-radius: 100px;
    display: flex; align-items: center; gap: 6px;
  }

  /* ===== SCREEN 4: RESULTS ===== */
  #screen-results {
    flex-direction: column;
    align-items: center;
    padding: 60px 20px;
  }

  .results-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 24px;
    padding: 48px;
    width: 100%;
    max-width: 640px;
  }

  .score-ring {
    width: 160px; height: 160px;
    margin: 0 auto 32px;
    position: relative;
  }

  .score-ring svg {
    transform: rotate(-90deg);
  }

  .score-ring circle {
    fill: none;
    stroke-width: 10;
    stroke-linecap: round;
  }

  .ring-bg { stroke: var(--border); }
  .ring-fill {
    stroke: url(#grad);
    stroke-dasharray: 440;
    stroke-dashoffset: 440;
    transition: stroke-dashoffset 1.5s ease;
  }

  .score-center {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  .score-number {
    font-family: 'Syne', sans-serif;
    font-size: 48px;
    font-weight: 800;
    background: linear-gradient(135deg, var(--accent2), var(--accent));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .score-label {
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    color: var(--muted);
    letter-spacing: 1px;
  }

  .verdict {
    text-align: center;
    margin-bottom: 32px;
  }

  .verdict-badge {
    display: inline-block;
    padding: 8px 24px;
    border-radius: 100px;
    font-family: 'Syne', sans-serif;
    font-weight: 700;
    font-size: 16px;
    margin-bottom: 12px;
  }

  .verdict-badge.good { background: rgba(6,214,160,0.15); color: var(--accent2); border: 1px solid rgba(6,214,160,0.3); }
  .verdict-badge.avg { background: rgba(255,214,10,0.15); color: var(--warn); border: 1px solid rgba(255,214,10,0.3); }
  .verdict-badge.bad { background: rgba(255,77,109,0.15); color: var(--danger); border: 1px solid rgba(255,77,109,0.3); }

  .verdict-text {
    font-size: 14px;
    color: var(--muted);
    line-height: 1.6;
  }

  .metrics-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 28px;
  }

  .metric-card {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px;
  }

  .metric-title {
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 8px;
  }

  .metric-value {
    font-family: 'Syne', sans-serif;
    font-size: 24px;
    font-weight: 700;
  }

  .metric-value.green { color: var(--accent2); }
  .metric-value.yellow { color: var(--warn); }
  .metric-value.red { color: var(--danger); }
  .metric-value.purple { color: #a78bfa; }

  .feedback-section {
    margin-bottom: 28px;
  }

  .feedback-title {
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 12px;
  }

  .feedback-item {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
    font-size: 14px;
    line-height: 1.5;
    color: var(--text);
  }

  .feedback-item .icon { flex-shrink: 0; margin-top: 2px; }

  .btn-secondary {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 14px;
    border-radius: 12px;
    font-family: 'Syne', sans-serif;
    font-size: 15px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btn-secondary:hover { border-color: var(--accent); color: var(--accent); }

  /* Typing indicator */
  .typing-indicator {
    display: flex; gap: 4px; align-items: center; padding: 4px 0;
  }
  .typing-dot {
    width: 6px; height: 6px;
    background: var(--muted);
    border-radius: 50%;
    animation: typingBounce 1.2s ease-in-out infinite;
  }
  .typing-dot:nth-child(2) { animation-delay: 0.2s; }
  .typing-dot:nth-child(3) { animation-delay: 0.4s; }
  @keyframes typingBounce {
    0%,60%,100% { transform: translateY(0); }
    30% { transform: translateY(-6px); }
  }

  /* Responsive */
  @media (max-width: 768px) {
    .interview-layout { grid-template-columns: 1fr; grid-template-rows: auto 1fr; height: auto; }
    .interview-sidebar { border-left: none; border-top: 1px solid var(--border); }
    .form-row { grid-template-columns: 1fr; }
    .metrics-grid { grid-template-columns: 1fr; }
  }

  /* Loading spinner */
  .spinner {
    width: 20px; height: 20px;
    border: 2px solid var(--border);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    display: inline-block;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  .hidden { display: none !important; }
</style>
</head>
<body>

<div class="glow-orb orb1"></div>
<div class="glow-orb orb2"></div>

<!-- ===== SCREEN 1: LANDING ===== -->
<div id="screen-landing" class="screen active">
  <div class="logo-mark">AI</div>
  <p class="landing-eyebrow">‚óè Live Now ‚Äî Zero Budget Demo</p>
  <h1 class="landing-title">Your AI<br>Interview Coach</h1>
  <p class="landing-sub">Practice interviews with a real AI interviewer. Get scored on your answers, confidence, and body language.</p>
  
  <div class="features-row">
    <div class="feat-chip"><span>üé•</span> Face Analysis</div>
    <div class="feat-chip"><span>üé§</span> Voice Detection</div>
    <div class="feat-chip"><span>ü§ñ</span> AI Questions</div>
    <div class="feat-chip"><span>üìä</span> Live Scoring</div>
  </div>

  <button class="btn-primary" onclick="goTo('profile')">Start Interview Practice ‚Üí</button>
</div>

<!-- ===== SCREEN 2: PROFILE ===== -->
<div id="screen-profile" class="screen">
  <div class="card">
    <div class="card-header">
      <p class="step-badge">Step 01 ‚Äî Setup</p>
      <h2 class="card-title">Tell us about yourself</h2>
    </div>

    <form onsubmit="startInterview(event)">
      <div class="form-group">
        <label>Full Name</label>
        <input type="text" id="f-name" placeholder="e.g. Ravi Kumar" required>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Degree</label>
          <select id="f-degree" required>
            <option value="">Select</option>
            <option>B.Tech</option>
            <option>B.E</option>
            <option>BCA</option>
            <option>MCA</option>
            <option>M.Tech</option>
            <option>MBA</option>
            <option>B.Sc</option>
            <option>Other</option>
          </select>
        </div>
        <div class="form-group">
          <label>Branch</label>
          <select id="f-branch" required>
            <option value="">Select</option>
            <option>CSE</option>
            <option>ECE</option>
            <option>EEE</option>
            <option>Mechanical</option>
            <option>Civil</option>
            <option>IT</option>
            <option>AIDS</option>
            <option>Other</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Year of Graduation</label>
          <select id="f-year" required>
            <option value="">Select</option>
            <option>2024</option>
            <option>2025</option>
            <option>2026</option>
            <option>2023</option>
            <option>2022 or earlier</option>
          </select>
        </div>
        <div class="form-group">
          <label>Target Role</label>
          <input type="text" id="f-role" placeholder="e.g. Software Engineer" required>
        </div>
      </div>

      <div class="form-group">
        <label>Skills (press Enter to add)</label>
        <input type="text" id="skill-input" placeholder="e.g. Python, React, SQL..." onkeydown="addSkill(event)">
        <div class="skills-tags" id="skills-tags"></div>
        <input type="hidden" id="f-skills">
      </div>

      <div class="form-group">
        <label>Experience Level</label>
        <select id="f-exp" required>
          <option value="">Select</option>
          <option>Fresher (0 years)</option>
          <option>0-1 years</option>
          <option>1-2 years</option>
          <option>2-5 years</option>
          <option>5+ years</option>
        </select>
      </div>

      <button type="submit" class="btn-primary" style="width:100%;margin-top:8px">
        Launch Interview ‚Üí
      </button>
    </form>
  </div>
</div>

<!-- ===== SCREEN 3: INTERVIEW ===== -->
<div id="screen-interview" class="screen">
  <div class="interview-layout">

    <!-- Main area -->
    <div class="interview-main">
      <div class="interview-header">
        <div class="interviewer-info">
          <div class="interviewer-avatar">ü§ñ</div>
          <div>
            <div class="interviewer-name">Alex AI</div>
            <div class="interviewer-role">Senior HR ¬∑ <span id="company-name">TechCorp Inc.</span></div>
          </div>
        </div>
        <div class="status-badge">
          <span style="width:6px;height:6px;background:var(--accent2);border-radius:50%;display:inline-block;animation:blink 1s infinite"></span>
          LIVE
        </div>
      </div>

      <!-- Chat -->
      <div class="chat-area" id="chat-area"></div>

      <!-- Voice Input -->
      <div class="voice-input-area">
        <div class="voice-visualizer" id="visualizer">
          <div class="voice-bar" style="height:6px"></div>
          <div class="voice-bar" style="height:12px"></div>
          <div class="voice-bar" style="height:8px"></div>
          <div class="voice-bar" style="height:18px"></div>
          <div class="voice-bar" style="height:10px"></div>
          <div class="voice-bar" style="height:22px"></div>
          <div class="voice-bar" style="height:8px"></div>
          <div class="voice-bar" style="height:16px"></div>
          <div class="voice-bar" style="height:6px"></div>
          <div class="voice-bar" style="height:14px"></div>
          <div class="voice-bar" style="height:10px"></div>
          <div class="voice-bar" style="height:20px"></div>
        </div>
        <div class="voice-controls">
          <button class="btn-mic idle" id="mic-btn" onclick="toggleMic()" title="Hold to speak">üé§</button>
          <textarea id="answer-text" placeholder="Your answer appears here after speaking, or type directly..."></textarea>
          <button class="btn-send" onclick="sendAnswer()">Send ‚Üí</button>
        </div>
        <div style="font-family:'DM Mono',monospace;font-size:11px;color:var(--muted);text-align:center" id="mic-status">
          Click mic to speak, or type your answer above
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="interview-sidebar">

      <!-- Webcam -->
      <div>
        <p class="progress-label" style="margin-bottom:10px">üì∑ Camera Feed</p>
        <div class="video-container">
          <video id="webcam" autoplay muted playsinline></video>
          <div class="video-overlay">
            <div class="cam-corner tl"></div>
            <div class="cam-corner tr"></div>
            <div class="cam-corner bl"></div>
            <div class="cam-corner br"></div>
            <div class="rec-indicator"><div class="rec-dot"></div> REC</div>
          </div>
        </div>
      </div>

      <!-- Emotion Analysis -->
      <div class="emotion-panel">
        <p class="emotion-title">üß† Emotion Analysis</p>
        <div class="emotion-bars">
          <div class="emotion-row">
            <span class="emotion-label">Confidence</span>
            <div class="emotion-bar-bg"><div class="emotion-bar-fill" id="bar-confidence" style="width:0%;background:#7c3aed"></div></div>
            <span class="emotion-val" id="val-confidence">0%</span>
          </div>
          <div class="emotion-row">
            <span class="emotion-label">Calm</span>
            <div class="emotion-bar-bg"><div class="emotion-bar-fill" id="bar-calm" style="width:0%;background:#06d6a0"></div></div>
            <span class="emotion-val" id="val-calm">0%</span>
          </div>
          <div class="emotion-row">
            <span class="emotion-label">Nervous</span>
            <div class="emotion-bar-bg"><div class="emotion-bar-fill" id="bar-nervous" style="width:0%;background:#f72585"></div></div>
            <span class="emotion-val" id="val-nervous">0%</span>
          </div>
          <div class="emotion-row">
            <span class="emotion-label">Focus</span>
            <div class="emotion-bar-bg"><div class="emotion-bar-fill" id="bar-focus" style="width:0%;background:#ffd60a"></div></div>
            <span class="emotion-val" id="val-focus">0%</span>
          </div>
        </div>
      </div>

      <!-- Progress -->
      <div class="progress-panel">
        <p class="progress-label">Interview Progress</p>
        <div class="progress-track">
          <div class="progress-fill" id="progress-fill" style="width:0%"></div>
        </div>
        <div class="progress-info">
          <span id="q-count">Question 0 / 5</span>
          <span id="time-elapsed">0:00</span>
        </div>
      </div>

      <!-- Live score -->
      <div class="progress-panel">
        <p class="progress-label">Live Score</p>
        <div style="font-family:'Syne',sans-serif;font-size:40px;font-weight:800;background:linear-gradient(135deg,var(--accent2),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent" id="live-score">
          --
        </div>
        <div style="font-size:12px;color:var(--muted);margin-top:4px">Updated after each answer</div>
      </div>

      <button class="btn-secondary" onclick="endInterview()" style="margin-top:auto">
        End Interview & Get Report
      </button>
    </div>
  </div>
</div>

<!-- ===== SCREEN 4: RESULTS ===== -->
<div id="screen-results" class="screen">
  <div class="results-card">
    <p class="step-badge" style="margin-bottom:8px">Interview Complete</p>
    <h2 style="font-family:'Syne',sans-serif;font-size:28px;font-weight:800;margin-bottom:32px">Your Report Card</h2>

    <div class="score-ring">
      <svg width="160" height="160" viewBox="0 0 160 160">
        <defs>
          <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" style="stop-color:#06d6a0"/>
            <stop offset="100%" style="stop-color:#7c3aed"/>
          </linearGradient>
        </defs>
        <circle class="ring-bg" cx="80" cy="80" r="70"/>
        <circle class="ring-fill" id="score-ring" cx="80" cy="80" r="70"/>
      </svg>
      <div class="score-center">
        <div class="score-number" id="final-score">0</div>
        <div class="score-label">/ 100</div>
      </div>
    </div>

    <div class="verdict" id="verdict-area"></div>

    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-title">Answer Quality</div>
        <div class="metric-value purple" id="m-quality">--</div>
      </div>
      <div class="metric-card">
        <div class="metric-title">Confidence</div>
        <div class="metric-value green" id="m-confidence">--</div>
      </div>
      <div class="metric-card">
        <div class="metric-title">Communication</div>
        <div class="metric-value yellow" id="m-comm">--</div>
      </div>
      <div class="metric-card">
        <div class="metric-title">Nervousness</div>
        <div class="metric-value red" id="m-nervous">--</div>
      </div>
    </div>

    <div class="feedback-section">
      <p class="feedback-title">AI Feedback</p>
      <div id="feedback-list"></div>
    </div>

    <button class="btn-primary" onclick="restart()" style="width:100%;margin-bottom:12px">
      Practice Again ‚Üí
    </button>
    <button class="btn-secondary" onclick="shareResults()">
      Copy Results Summary
    </button>
  </div>
</div>

<script>
// ============================================================
//  STATE
// ============================================================
const state = {
  profile: {},
  skills: [],
  questionCount: 0,
  maxQuestions: 5,
  answers: [],
  emotionHistory: [],
  startTime: null,
  timer: null,
  recognizing: false,
  recognition: null,
  mediaStream: null,
  emotionInterval: null,
  scores: [],
  n8nWebhookUrl: 'http://localhost:5678/webhook/interview', // Change this to your n8n webhook!
};

// ============================================================
//  NAVIGATION
// ============================================================
function goTo(screenId) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-' + screenId).classList.add('active');
}

// ============================================================
//  SKILLS INPUT
// ============================================================
function addSkill(e) {
  if (e.key === 'Enter') {
    e.preventDefault();
    const val = e.target.value.trim();
    if (!val || state.skills.includes(val)) return;
    state.skills.push(val);
    renderSkillTags();
    e.target.value = '';
  }
}

function renderSkillTags() {
  const container = document.getElementById('skills-tags');
  container.innerHTML = state.skills.map(s =>
    `<span class="skill-tag" onclick="removeSkill('${s}')">${s} ‚úï</span>`
  ).join('');
  document.getElementById('f-skills').value = state.skills.join(', ');
}

function removeSkill(s) {
  state.skills = state.skills.filter(x => x !== s);
  renderSkillTags();
}

// ============================================================
//  START INTERVIEW
// ============================================================
async function startInterview(e) {
  e.preventDefault();
  state.profile = {
    name: document.getElementById('f-name').value,
    degree: document.getElementById('f-degree').value,
    branch: document.getElementById('f-branch').value,
    year: document.getElementById('f-year').value,
    role: document.getElementById('f-role').value,
    skills: state.skills.join(', '),
    experience: document.getElementById('f-exp').value,
  };

  goTo('interview');
  await startCamera();
  startTimer();
  startEmotionSimulation();
  askFirstQuestion();
}

// ============================================================
//  CAMERA
// ============================================================
async function startCamera() {
  try {
    state.mediaStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
    document.getElementById('webcam').srcObject = state.mediaStream;
  } catch(err) {
    console.log('Camera not available:', err);
  }
}

// ============================================================
//  TIMER
// ============================================================
function startTimer() {
  state.startTime = Date.now();
  state.timer = setInterval(() => {
    const secs = Math.floor((Date.now() - state.startTime) / 1000);
    const m = Math.floor(secs / 60);
    const s = secs % 60;
    document.getElementById('time-elapsed').textContent = `${m}:${s.toString().padStart(2,'0')}`;
  }, 1000);
}

// ============================================================
//  EMOTION SIMULATION (Replace with real MediaPipe later!)
// ============================================================
function startEmotionSimulation() {
  // Simulates emotion detection - in production connect MediaPipe here
  state.emotionInterval = setInterval(() => {
    const conf = 40 + Math.random() * 50;
    const calm = 30 + Math.random() * 60;
    const nervous = Math.max(0, 100 - conf - 10 + Math.random()*20);
    const focus = 50 + Math.random() * 45;

    updateBar('confidence', conf);
    updateBar('calm', calm);
    updateBar('nervous', nervous);
    updateBar('focus', focus);

    state.emotionHistory.push({ conf, calm, nervous, focus });
  }, 2000);
}

function updateBar(name, val) {
  const v = Math.min(100, Math.round(val));
  document.getElementById(`bar-${name}`).style.width = v + '%';
  document.getElementById(`val-${name}`).textContent = v + '%';
}

// ============================================================
//  QUESTIONS via n8n OR fallback
// ============================================================
const fallbackQuestions = [
  (p) => `Hello ${p.name}! Welcome to this interview for the ${p.role} position. Could you start by introducing yourself and telling me about your background?`,
  (p) => `You have experience with ${p.skills || 'various technologies'}. Can you walk me through a project where you applied these skills?`,
  (p) => `What are your greatest strengths and how do they make you a good fit for the ${p.role} role?`,
  (p) => `Tell me about a challenging problem you faced during your studies or work, and how you solved it.`,
  (p) => `Where do you see yourself in 5 years? Why are you specifically interested in this ${p.role} position?`,
];

async function askQuestion(questionText) {
  state.questionCount++;
  updateProgress();
  addMessage('ai', questionText);
}

async function askFirstQuestion() {
  addTypingIndicator();
  await sleep(1500);
  removeTypingIndicator();
  const q = fallbackQuestions[0](state.profile);
  await askQuestion(q);

  // Try to fetch from n8n
  try {
    const res = await fetch(state.n8nWebhookUrl, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ type: 'start', profile: state.profile }),
      signal: AbortSignal.timeout(3000)
    });
    if (res.ok) {
      const data = await res.json();
      if (data.question) {
        document.querySelector('.msg-bubble.ai-bubble:last-of-type').textContent = data.question;
      }
    }
  } catch(e) {
    // n8n not running ‚Äî using local fallback (demo mode)
    console.log('n8n not connected, using demo mode');
  }
}

async function getNextQuestion(userAnswer) {
  addTypingIndicator();
  await sleep(1500 + Math.random() * 1000);
  removeTypingIndicator();

  // Score this answer
  const score = 50 + Math.random() * 50;
  state.scores.push(score);
  const avgScore = Math.round(state.scores.reduce((a,b) => a+b, 0) / state.scores.length);
  document.getElementById('live-score').textContent = avgScore;

  if (state.questionCount >= state.maxQuestions) {
    addMessage('ai', `Thank you ${state.profile.name}! That concludes our interview. You did great. Click "End Interview & Get Report" to see your detailed analysis.`);
    return;
  }

  // Try n8n first, fallback to local
  let question = fallbackQuestions[Math.min(state.questionCount, fallbackQuestions.length-1)](state.profile);

  try {
    const res = await fetch(state.n8nWebhookUrl, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ type: 'answer', answer: userAnswer, questionNum: state.questionCount, profile: state.profile }),
      signal: AbortSignal.timeout(3000)
    });
    if (res.ok) {
      const data = await res.json();
      if (data.question) question = data.question;
    }
  } catch(e) {}

  await askQuestion(question);
}

// ============================================================
//  CHAT UI
// ============================================================
function addMessage(role, text) {
  const chat = document.getElementById('chat-area');
  const div = document.createElement('div');
  div.className = 'message';
  div.innerHTML = `
    <div class="msg-avatar ${role === 'ai' ? 'ai' : 'user'}">${role === 'ai' ? 'ü§ñ' : 'üë§'}</div>
    <div>
      <div class="msg-meta">${role === 'ai' ? 'Alex AI ‚Äî Interviewer' : state.profile.name || 'You'} ¬∑ now</div>
      <div class="msg-bubble ${role === 'ai' ? 'ai-bubble' : ''}">${text}</div>
    </div>
  `;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function addTypingIndicator() {
  const chat = document.getElementById('chat-area');
  const div = document.createElement('div');
  div.className = 'message'; div.id = 'typing-msg';
  div.innerHTML = `
    <div class="msg-avatar ai">ü§ñ</div>
    <div>
      <div class="msg-meta">Alex AI is typing...</div>
      <div class="msg-bubble ai-bubble">
        <div class="typing-indicator">
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
        </div>
      </div>
    </div>
  `;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function removeTypingIndicator() {
  const el = document.getElementById('typing-msg');
  if (el) el.remove();
}

function updateProgress() {
  const pct = (state.questionCount / state.maxQuestions) * 100;
  document.getElementById('progress-fill').style.width = pct + '%';
  document.getElementById('q-count').textContent = `Question ${state.questionCount} / ${state.maxQuestions}`;
}

// ============================================================
//  SEND ANSWER
// ============================================================
async function sendAnswer() {
  const text = document.getElementById('answer-text').value.trim();
  if (!text) return;
  addMessage('user', text);
  document.getElementById('answer-text').value = '';
  state.answers.push(text);
  await getNextQuestion(text);
}

// ============================================================
//  VOICE INPUT (Web Speech API)
// ============================================================
function toggleMic() {
  if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
    document.getElementById('mic-status').textContent = '‚ö†Ô∏è Speech API not supported in this browser. Use Chrome!';
    return;
  }

  if (state.recognizing) {
    state.recognition.stop();
    return;
  }

  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  state.recognition = new SR();
  state.recognition.lang = 'en-US';
  state.recognition.continuous = true;
  state.recognition.interimResults = true;

  state.recognition.onstart = () => {
    state.recognizing = true;
    document.getElementById('mic-btn').className = 'btn-mic recording';
    document.getElementById('mic-btn').textContent = '‚èπ';
    document.getElementById('mic-status').textContent = 'üî¥ Recording... speak now';
    document.querySelectorAll('.voice-bar').forEach(b => b.classList.add('active'));
  };

  state.recognition.onresult = (e) => {
    let transcript = '';
    for (let i = e.resultIndex; i < e.results.length; i++) {
      transcript += e.results[i][0].transcript;
    }
    document.getElementById('answer-text').value = transcript;
  };

  state.recognition.onend = () => {
    state.recognizing = false;
    document.getElementById('mic-btn').className = 'btn-mic idle';
    document.getElementById('mic-btn').textContent = 'üé§';
    document.getElementById('mic-status').textContent = 'Click mic to speak, or type your answer above';
    document.querySelectorAll('.voice-bar').forEach(b => b.classList.remove('active'));
  };

  state.recognition.start();
}

// ============================================================
//  END INTERVIEW & RESULTS
// ============================================================
function endInterview() {
  clearInterval(state.timer);
  clearInterval(state.emotionInterval);
  if (state.recognition) state.recognition.stop();
  if (state.mediaStream) state.mediaStream.getTracks().forEach(t => t.stop());

  generateResults();
  goTo('results');
}

function generateResults() {
  const avgScore = state.scores.length > 0
    ? Math.round(state.scores.reduce((a,b) => a+b, 0) / state.scores.length)
    : 55 + Math.round(Math.random() * 30);

  const avgEmotion = state.emotionHistory.length > 0 ? {
    conf: Math.round(state.emotionHistory.reduce((a,b) => a + b.conf, 0) / state.emotionHistory.length),
    calm: Math.round(state.emotionHistory.reduce((a,b) => a + b.calm, 0) / state.emotionHistory.length),
    nervous: Math.round(state.emotionHistory.reduce((a,b) => a + b.nervous, 0) / state.emotionHistory.length),
    focus: Math.round(state.emotionHistory.reduce((a,b) => a + b.focus, 0) / state.emotionHistory.length),
  } : { conf: 65, calm: 70, nervous: 30, focus: 72 };

  // Animate score ring
  document.getElementById('final-score').textContent = avgScore;
  const ringEl = document.getElementById('score-ring');
  const circumference = 2 * Math.PI * 70; // ~440
  setTimeout(() => {
    ringEl.style.strokeDashoffset = circumference - (avgScore / 100) * circumference;
  }, 100);

  // Verdict
  let verdictClass, verdictText, verdictMsg;
  if (avgScore >= 75) {
    verdictClass = 'good'; verdictText = '‚úÖ Interview Ready!';
    verdictMsg = `Great job ${state.profile.name}! You performed well and are ready for real interviews. Keep practicing to maintain this level.`;
  } else if (avgScore >= 50) {
    verdictClass = 'avg'; verdictText = '‚ö° Almost There!';
    verdictMsg = `You have a good foundation ${state.profile.name}, but there are a few areas to improve. Practice more and you'll be ready soon!`;
  } else {
    verdictClass = 'bad'; verdictText = 'üìö Needs More Practice';
    verdictMsg = `Don't worry ${state.profile.name}! Every interview is a learning experience. Focus on the feedback below and practice regularly.`;
  }

  document.getElementById('verdict-area').innerHTML = `
    <div class="verdict-badge ${verdictClass}">${verdictText}</div>
    <p class="verdict-text">${verdictMsg}</p>
  `;

  // Metrics
  document.getElementById('m-quality').textContent = avgScore + '%';
  document.getElementById('m-confidence').textContent = avgEmotion.conf + '%';
  document.getElementById('m-comm').textContent = Math.round((avgScore + avgEmotion.focus) / 2) + '%';
  document.getElementById('m-nervous').textContent = avgEmotion.nervous + '%';

  // Feedback
  const feedbacks = getFeedback(avgScore, avgEmotion);
  document.getElementById('feedback-list').innerHTML = feedbacks.map(f =>
    `<div class="feedback-item"><span class="icon">${f.icon}</span><span>${f.text}</span></div>`
  ).join('');
}

function getFeedback(score, em) {
  const items = [];
  if (score >= 75) items.push({ icon: '‚úÖ', text: 'Strong overall performance across all questions.' });
  if (score < 75) items.push({ icon: 'üí°', text: 'Work on structuring answers using the STAR method (Situation, Task, Action, Result).' });
  if (em.conf > 60) items.push({ icon: 'üí™', text: 'Good confidence levels detected during the interview.' });
  if (em.conf < 60) items.push({ icon: 'üéØ', text: 'Practice in front of a mirror to improve confidence and body language.' });
  if (em.nervous > 50) items.push({ icon: 'üò§', text: 'High nervousness detected. Try breathing exercises before your next interview.' });
  if (em.focus > 70) items.push({ icon: 'üéØ', text: 'Excellent focus and engagement throughout the session.' });
  items.push({ icon: 'üìñ', text: `Review common ${state.profile.role || 'technical'} interview questions and prepare example stories.` });
  items.push({ icon: 'üîÅ', text: 'Practice at least 3 mock interviews per week for best results.' });
  return items;
}

// ============================================================
//  UTILS
// ============================================================
function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }

function restart() {
  state.questionCount = 0;
  state.answers = [];
  state.emotionHistory = [];
  state.scores = [];
  state.skills = [];
  document.getElementById('chat-area').innerHTML = '';
  document.getElementById('skills-tags').innerHTML = '';
  goTo('landing');
}

function shareResults() {
  const score = document.getElementById('final-score').textContent;
  const text = `ü§ñ InterviewAI Results\nüë§ ${state.profile.name}\nüéì ${state.profile.degree} ${state.profile.branch}\nüéØ Role: ${state.profile.role}\nüìä Score: ${score}/100\n\nPracticed with AI Interview Coach!`;
  navigator.clipboard.writeText(text).then(() => {
    alert('Results copied to clipboard!');
  });
}

// Handle Enter key in answer box
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('answer-text').addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendAnswer();
    }
  });
});
</script>
</body>
</html>
